SpringCloud搭建网关

微服务网关产生背景

1.网关：API（接口）Gateway（网关）----接口网关注意：没有界面
	网关：相当于客户端统一先请求到网关服务器上，再由网关服务器统一进行转发到实际的服务地址上。类似：nginx
		网关作用：网关可以（拦截所有服务会话统一处理）拦截客户端所有请求，对该请求进行权限控制、负载均衡（Ribbon）、统一异常处理、预防XSS攻击和Sql注入、日志管理、接口调用监控，路由转发、性能监控、黑名单、白名单等。
		过滤器与网关的区别：
			过滤器适合拦截单个tomcat服务器进行拦截请求
			网关是拦截整个微服务所有请求
		Nginx与Zuul网关区别
			相同点：都可以实现反向代理和负载均衡，都可以过滤请求，可以实现网关的效果
			不同点：nginx使用C语言编写，使用多路复用，zuul使用java语言编写，zuul本地负载均衡实现是通过ribbon，eureka实现
			nginx是采用服务器端实现负载均衡，也可以实现网关。
			nginx 比 Zuul 功能更加强大，因为nginx可以整合脚本语言（lua），所以nginx适合服务器端负载均衡
			zuul 适合在微服务中实现网关
			最好建议Nginx+zuul实现网关
			Nginx作用实现反向代理，隐藏真实ip
			Zuul对微服务实现网关（请求）拦截


2.接口在什么背景下产生？在面向架构和微服务背景的Rpc远程调用中下产生 目的是为了应用解耦。

3.接口的分类
	1.开放接口---开放给其他机构（合作伙伴）调用（必须在外网访问/或者专线）
		ios 开发 ----需要通过appid+appSocket 使用accessToken进行通讯。对接支付开发、微信开发
		目的是可以授权一些接口协议（OAuth2.0授权）协议方式
	2.内部接口---
		一般只能在局域网中进行访问，服务与服务之间调用关系都是在同一个微服务系统中。
		目的是为了保证安全性。

项目接口如何设计*********
	需要考虑：接口权限（内部接口（搭建开放平台，授权使用OAuth2.0协议）|外部接口（必须在同一局域网中还要经过网关转发请求））
	考虑幂等性、安全性（https）防止篡改数据（验证签名）、使用网关拦截接口实现黑名单白名单、接口使用http协议+json格式（Restful风格）（目的为了跨平台）、考虑高并发，对服务接口实现保护服务降级、熔断、隔离、限流。最后使用统一API管理平台管理API（swagger）

使用Zuul 网关组件过滤请求
	在微服务系统中，如何对整个服务项目进行登录拦截 

配置Zuul：可以实现反向代理，隐藏真实ip ，默认整合Rebbin 本地负载均衡
	原理：zuul自动实现负载均衡轮询效果 zuul配置去eureka找服务别名，本地实现转发请求 （负载均衡）

动态网关路由转发：
	使用SpringCloud Config 读取配置文件   
	修改之后使用接口 http://localhost:8082/actuator/refresh 调用刷新配置文件

互联网公司网关都是集群
Zuul怎么搭建集群的？
搭建Nginx+Zuul实现高性能网关
	客户端发送请求统一到Nginx服务器上，再使用Nginx实现反向代理和负载均衡，采用轮询算法转发到Zuul网关（集群）上

既然Nginx也可以实现网关功能，那么为什么不用Nginx实现网关
1.需要会写Lua脚本
2.因为微服务网关是针对整个微服务实现统一请求拦截，网关基本上都采用自己熟悉的语言开发  通讯麻烦
	目的：省钱
